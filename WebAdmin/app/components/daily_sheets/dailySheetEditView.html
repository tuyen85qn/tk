<!-- Content Header (Page header) -->
<section class="content-header">
    <h1>
        Cập nhật thống kê
    </h1>
    <ol class="breadcrumb">
        <li><a href="#"><i class="fa fa-dashboard"></i> Trang chủ</a></li>
        <li><a ui-sref="situations">Thống kê</a></li>
        <li class="active">Cập nhật</li>
    </ol>
</section>
<!-- Main content -->
<section class="content">
    <!-- Horizontal Form -->
    <div class="box box-info">
        <div class="box-header with-border">
            <h3 class="box-title">{{statistic.Name}}</h3>
        </div><!-- /.box-header -->
        <!-- form start -->
        <form class="form-horizontal" novalidate name="frmEditStatistic" role="form" ng-submit="updateStatistic()">
            <div class="box-body">
                <div class="form-group">
                    <label for="inputEmail3" class="col-sm-2 control-label">Tên thống kê</label>
                    <div class="col-sm-6">
                        <input type="text" class="form-control" name="name" required ng-change="GetSeoTitle()" ng-model="statistic.Name">
                    </div>
                    <div class="col-sm-4 pull-left">
                        <i class="fa fa-check text-success" ng-show="frmEditStatistic.name.$dirty && frmEditStatistic.name.$valid"></i>
                        <div ng-show="frmEditStatistic.name.$pristine && frmEditStatistic.name.$invalid" class="text-danger">
                            <i class="fa fa-times text-danger"></i>
                            <span ng-show="frmEditStatistic.$error.required">Không được bỏ trống</span>
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <label for="inputEmail3" class="col-sm-2 control-label">Tiêu đề SEO</label>
                    <div class="col-sm-6">
                        <input type="text" class="form-control" name="alias" ng-model="statistic.Alias">
                    </div>
                </div>
                <div class="form-group">
                    <label for="inputEmail3" class="col-sm-2 control-label">Từ ngày</label>
                    <div class="col-sm-6">
                        <input type="text" class="form-control" name="fromdate"
                               datetime-directive options="{format:'YYYY-MM-DD'}" ng-model="statistic.FromDate">
                    </div>
                    <div class="col-sm-4 pull-left">
                        <i class="fa fa-check text-success" ng-show="frmEditStatistic.fromdate.$dirty && frmEditStatistic.fromdate.$valid"></i>
                        <div ng-show="frmEditStatistic.fromdate.$pristine && frmEditStatistic.fromdate.$invalid" class="text-danger">
                            <i class="fa fa-times text-danger"></i>
                            <span ng-show="frmEditStatistic.$error.required">Không được để trống</span>
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <label for="inputEmail3" class="col-sm-2 control-label">Đến ngày</label>
                    <div class="col-sm-6">
                        <input type="text" class="form-control" name="todate"
                               datetime-directive options="{format:'YYYY-MM-DD'}" ng-model="statistic.ToDate">
                    </div>
                    <div class="col-sm-4 pull-left">
                        <i class="fa fa-check text-success" ng-show="frmEditStatistic.todate.$dirty && frmEditStatistic.todate.$valid"></i>
                        <div ng-show="frmEditStatistic.todate.$pristine && frmEditStatistic.todate.$invalid" class="text-danger">
                            <i class="fa fa-times text-danger"></i>
                            <span ng-show="frmEditStatistic.$error.required">Không được để trống</span>
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <label for="inputEmail3" class="col-sm-2 control-label">Danh mục</label>
                    <div class="col-sm-6">
                        <select name="statisticCategoryId" required class="form-control" ng-model="statistic.StatisticCategoryID" ng-options="option.ID as option.Name for option in statisticCategories">
                            <option value="">Danh mục thống kê</option>
                        </select>
                    </div>
                </div>
                <div class="form-group">
                    <label for="inputEmail3" class="col-sm-2 control-label">Tỉnh/Thành phố</label>
                    <div class="col-sm-6">
                        <select name="province" required class="form-control" ng-change="getDistrictByProvinceId(statistic.ProvinceID)" ng-model="statistic.ProvinceID" ng-options="option.ID as option.Name for option in provinces">
                            <option value="">--Tỉnh/Thành phố--</option>
                        </select>
                    </div>
                </div>
                <div class="form-group">
                    <label for="inputEmail3" class="col-sm-2 control-label">Quận/Huyện/Thị xã</label>
                    <div class="col-sm-6">
                        <select name="district" ng-disabled="districtid"
                                required class="form-control" ng-model="statistic.DistrictID" ng-options="option.ID as option.Name for option in districts">
                            <option value="">--Quận/Huyện/Thị xã--</option>
                        </select>
                    </div>
                </div>

                <div class="form-group">
                    <label for="inputEmail3" class="col-sm-2 control-label">Tình trạng giải quyết</label>
                    <div class="col-sm-6">
                        <select name="resolvedStatisticId" required class="form-control" ng-model="statistic.ResolvedSituationID" ng-options="option.ID as option.Name for option in resolvedSituations">
                            <option value="">Tình trạng giải quyết</option>
                        </select>
                    </div>
                </div>
                <div class="form-group" ng-hide="hideResult">
                    <div class="box-rs">
                        <div class="panel panel-primary">
                            <!-- Default panel contents -->
                            <div class="panel-heading">
                                <h3 style="font-weight:bold">Kết quả</h3>
                            </div>
                            <div class="panel-body">
                                <p class="col-md-5 col-offset-1">Tổng số vụ: <span class="show-rs">{{statistic.TotalSituationCount}}</span> vụ</p>
                                <p class="result">Số người chết: <span class="show-rs">{{statistic.TheDead}}</span> người</p>
                                <p class="col-md-5 col-offset-1">Số người bị thương: <span class="show-rs">{{statistic.TheInjured}}</span> người</p>
                                <p class="result">Tổng thiệt hại tài sản khoảng: <span class="show-rs">{{statistic.PropertyDamage}}</span> VNĐ</p>
                                <!-- Table -->
                                <table class="table">
                                    <tr>
                                        <th style="width: 5%">ID</th>
                                        <th style="width: 20%">Loại tình hình</th>
                                        <th style="width: 10%">Ngày xảy ra</th>
                                        <th style="width: 20%">Địa điểm</th>
                                        <th style="width: 10%">Trạng thái</th>
                                        <th style="width: 10%">Thao tác</th>
                                    </tr>
                                    <tr ng-repeat="item in listSituations">
                                        <td>{{item.ID}}</td>
                                        <td>{{item.SituationCategoryName}}</td>
                                        <td>
                                            {{item.OccurenceDay}}
                                        </td>
                                        <td>
                                            {{item.Place}}
                                        </td>
                                        <td>
                                            <span ng-class="{'badge bg-red':item.Status==false,'badge bg-green':item.Status==true}">
                                                {{item.Status | statusFilter}}
                                            </span>
                                        </td>
                                        <td>
                                            <button class="btn btn-sm btn-primary" ui-sref="detail_situation({id:item.ID})"><i class="fa fa-pencil"></i></button>
                                        </td>
                                    </tr>
                                    <tfoot>
                                        <tr>
                                            <td colspan="6"><span class="pull-right">Trang {{page+1}}Tổng số bản ghi: {{totalCount}}</span></td>
                                        </tr>
                                    </tfoot>
                                </table>
                            </div>
                            <div class="panel-footer">
                                <pager-directive page="{{page}}" custom-path="{{customPath}}" pages-count="{{pagesCount}}" total-count="{{totalCount}}" search-func="search(page)"></pager-directive>
                            </div>
                        </div>
                    </div>
                </div>
            </div><!-- /.box-body -->
            <div class="box-footer">
                <button ui-sref="statistics" class="btn btn-default">Hủy</button>
                <button type="button" class="btn btn-success pull-right" ng-click="search()">Thống kê <i class="fa fa-save"></i></button>
                <button type="submit" class="btn btn-success">Sửa <i class="fa fa-save"></i></button>
            </div><!-- /.box-footer -->
        </form>
    </div><!-- /.box -->
</section><!-- /.content -->
